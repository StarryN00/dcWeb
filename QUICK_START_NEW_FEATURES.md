# 🚀 快速启动指南

本指南帮助你快速启动装修公司官网项目并测试新功能。

---

## 📋 前置要求

- ✅ Node.js 18+ 已安装
- ✅ PostgreSQL 数据库已配置
- ✅ 项目依赖已安装 (`npm install`)

---

## 🏃 快速启动步骤

### 1. 启动数据库 (如果使用Docker)

```bash
npm run db:start
```

等待5-10秒,让数据库完全启动。

### 2. 初始化数据库 (首次运行)

```bash
# 生成Prisma Client
npx prisma generate

# 推送数据库表结构
npm run db:push

# 创建管理员账户
npx ts-node prisma/seed-admin.ts

# 填充示例数据 (可选)
npm run db:seed
```

### 3. 启动开发服务器

```bash
npm run dev
```

服务器将在 **http://localhost:3600** 启动。

---

## 🔑 登录管理后台

1. 访问: **http://localhost:3600/admin/login**
2. 输入凭据:
   - **用户名**: `admin`
   - **密码**: `admin123`
3. 点击登录

---

## ✨ 新功能测试清单

### 1️⃣ 测试案例创建功能

1. 登录管理后台
2. 进入 **案例管理** 页面
3. 点击 **"创建案例"** 按钮
4. 填写表单:
   ```
   案例标题: 现代简约三居室
   项目位置: 杭州·滨江区
   装修风格: 现代
   面积: 120
   工期: 90
   总价: 28.5
   图片URL: (每行一个URL或逗号分隔)
     https://images.unsplash.com/photo-1600210492486-724fe5c67fb0
     https://images.unsplash.com/photo-1600607687939-ce8a6c25118c
   项目描述: (详细描述项目特点)
   业主感言: (业主评价)
   施工队长: 张师傅
   联系电话: 13800138000
   装修阶段: 完工
   推荐案例: ✅ (可选)
   发布状态: 已发布
   ```
5. 点击 **"创建案例"**
6. ✅ 验证: 案例出现在列表中

---

### 2️⃣ 测试案例编辑功能

1. 在案例列表中找到刚创建的案例
2. 点击 **编辑图标** (蓝色铅笔)
3. 修改任意字段 (例如: 标题改为 "现代极简三居室")
4. 点击 **"保存更改"**
5. ✅ 验证: 修改生效,列表中显示新内容

---

### 3️⃣ 测试统计数据准确性

1. 进入 **仪表盘** 页面
2. 查看统计卡片:
   - **总案例数**: 应显示真实数量
   - **总潜客数**: 应显示真实数量
   - **转化率**: 应显示实时计算的百分比
   - **推荐案例**: 应显示已标记推荐的案例数
3. 创建一个新案例并标记为推荐
4. 刷新仪表盘
5. ✅ 验证: 推荐案例数量+1

---

### 4️⃣ 测试CSV导出功能

1. 进入 **潜客管理** 页面
2. 确保有至少1条潜客数据
   - 如果没有,访问前台问答向导提交一条测试数据
3. 点击 **"导出CSV"** 按钮
4. 下载文件 (文件名格式: `潜客数据_20260118_1430.csv`)
5. 用Excel或文本编辑器打开
6. ✅ 验证:
   - 中文正确显示 (无乱码)
   - 包含所有字段 (12列)
   - 数据完整准确

---

## 🧪 完整功能流程测试

### 场景: 完整的案例管理流程

```
1. 创建草稿案例
   → 状态: 草稿 (不在前台显示)

2. 编辑案例内容
   → 修改描述、图片等

3. 切换为已发布
   → 点击状态按钮

4. 标记为推荐
   → 点击星标

5. 访问前台首页
   → http://localhost:3600
   → 验证案例出现在首页

6. 回到管理后台删除案例
   → 确认删除提示
   → 案例从列表中消失
```

---

## 🐛 常见问题

### 问题1: 端口被占用

**错误**: `Error: listen EADDRINUSE: address already in use :::3600`

**解决方案**:
```bash
# Windows
netstat -ano | findstr :3600
taskkill /PID <进程ID> /F

# Linux/Mac
lsof -ti:3600 | xargs kill -9
```

### 问题2: 数据库连接失败

**错误**: `ECONNREFUSED localhost:5432`

**解决方案**:
1. 确认Docker已启动
2. 运行 `npm run db:start`
3. 等待10秒后重试

### 问题3: Prisma Client未生成

**错误**: `Cannot find module '@prisma/client'`

**解决方案**:
```bash
npx prisma generate
```

### 问题4: NextAuth认证错误

**错误**: `[auth][error] CallbackRouteError`

**解决方案**:
1. 检查 `.env` 文件中的 `NEXTAUTH_URL` 是否正确
2. 确保端口号与实际运行端口一致
3. 重启开发服务器

---

## 📊 数据库管理

### 查看数据库 (Prisma Studio)

```bash
npm run db:studio
```

访问: **http://localhost:5555**

### 重置数据库 (清空所有数据)

```bash
npm run db:reset
```

**警告**: 此操作会删除所有数据!

### 手动创建管理员

```bash
npx ts-node prisma/seed-admin.ts
```

---

## 🔗 常用链接

- **前台首页**: http://localhost:3600
- **案例列表**: http://localhost:3600/cases
- **问答向导**: http://localhost:3600/wizard
- **管理后台登录**: http://localhost:3600/admin/login
- **管理后台**: http://localhost:3600/admin
- **数据库管理**: http://localhost:5555 (运行`npm run db:studio`后)

---

## 📞 需要帮助?

如果遇到问题:

1. 查看终端错误日志
2. 检查浏览器控制台 (F12)
3. 查看 `DEVELOPMENT_REPORT.md` 了解详细功能说明
4. 查看 `PROJECT_SUMMARY.md` 了解项目整体架构

---

## 🎉 测试完成检查清单

- [ ] 开发服务器成功启动在3600端口
- [ ] 成功登录管理后台
- [ ] 创建案例功能正常
- [ ] 编辑案例功能正常
- [ ] 删除案例需要二次确认
- [ ] 状态切换功能正常
- [ ] 统计数据准确显示
- [ ] CSV导出功能正常,中文无乱码
- [ ] 前台可以看到已发布的案例
- [ ] 推荐案例出现在首页

---

**祝测试顺利!** 🚀

如果一切正常,你的装修公司官网管理后台已经完全可用了!
